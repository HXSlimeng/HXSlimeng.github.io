var a=Object.defineProperty,t=(t,e,l)=>(((t,e,l)=>{e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[e]=l})(t,"symbol"!=typeof e?e+"":e,l),l);import{_ as e,d as l,x as s,e as o,g as n,o as r,c as d,b as c,F as i,r as u,n as p,u as b,t as m,w as v,y,m as h,p as g,a as f,z as x,A as w,B as j}from"./index.23c002ca.js";import"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js";import"https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js";class I{constructor(){t(this,"valueArr",[])}add(a){this.valueArr.push(a)}remove(a){this.valueArr.splice(a,1)}get value(){return this.valueArr.reduce(((a,t)=>a+t),0)}}class k{constructor(){t(this,"allData",[])}get summation(){return this.allData.reduce(((a,t)=>(Object.entries(t.cateObj).forEach((([t,e])=>{Reflect.get(a,t)?a[t]+=e.value:Reflect.set(a,t,e.value)})),a)),{})}get allin(){return this.allData.reduce(((a,t)=>a+t.allin),0)}get compData(){return this.allData.sort(((a,t)=>new Date(a.date).getTime()-new Date(t.date).getTime()))}}class D{constructor(a,t){this.date=a,this.cateObj=t}get allin(){return Object.values(this.cateObj).reduce(((a,t)=>a+t.value),0)}}const O=a=>(g("data-v-0736ea40"),a=a(),f(),a),_={class:"tableDataRoot"},A=O((()=>c("button",{type:"button",class:"btn btn-primary m-3","data-bs-toggle":"modal","data-bs-target":"#dateModal"},"+",-1))),E={class:"table-responsive m-3"},C={class:"table table-sm table-bordered caption-top"},$=O((()=>c("th",{scope:"col"},"日期",-1))),M=O((()=>c("th",null,"总计",-1))),S=O((()=>c("td",{class:"bg-body-secondary",style:{color:"#0a58ca"}},"合计",-1))),B={class:"bg-body-secondary",style:{color:"#0a58ca"}},L={class:"bg-body-secondary",style:{color:"#0a58ca"}},T={class:"modal fade",id:"dateModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","data-backdrop":"static","aria-hidden":"true"},R={class:"modal-dialog"},F={class:"modal-content"},P=O((()=>c("div",{class:"modal-header"},[c("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"添加日期"),c("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),U={class:"modal-body"},z=O((()=>c("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1))),N={class:"accordion",id:"accordionExample"},V={class:"accordion-item"},X=["data-bs-target","aria-controls"],q={class:"d-flex d-flex justify-content-between w-100"},G={class:"badge text-bg-primary"},H={class:"badge text-bg-warning"},J=["id"],K={class:"accordion-body"},Q={class:"mb-1"},W={class:"input-group input-group-sm",style:{width:"160px"}},Y={class:"input-group-text"},Z=O((()=>c("input",{type:"number",width:"20px",class:"form-control","aria-label":"Username"},null,-1))),aa=["onClick"],ta={class:"badge"};var ea=e(l({__name:"TableData",props:{dataIns:null},setup(a){const t=a,{dataIns:e}=s(t),l=x("categorys"),g=o();n((()=>{document.documentElement.setAttribute("data-bs-theme","dark"),g.value=new bootstrap.Modal(document.getElementById("dateModal"),{keyboard:!1})}));const f=o(null),w=()=>{if(!f)return;let a=l.map((({prop:a})=>[a,new I]));e.value.allData.push(new D(f.value,Object.fromEntries([...a]))),g.value.hide()};return n((function(){document.getElementById("dateModal").addEventListener("hidden.bs.modal",(()=>{f.value=null}))})),(a,t)=>(r(),d("div",_,[A,c("div",E,[c("table",C,[c("thead",null,[c("tr",null,[$,(r(!0),d(i,null,u(b(l),(a=>(r(),d("th",null,[c("i",{class:p(a.icon),style:{color:"#0d6efd"}},null,2)])))),256)),M])]),c("tbody",null,[(r(!0),d(i,null,u(b(e).compData,((a,t)=>(r(),d("tr",null,[c("td",null,m(a.date),1),(r(!0),d(i,null,u(b(l),((t,e)=>(r(),d("td",null,m(a.cateObj[t.prop].value),1)))),256)),c("td",null,m(a.allin),1)])))),256)),c("tr",null,[S,(r(!0),d(i,null,u(b(l),((a,t)=>(r(),d("td",B,m(b(e).summation[a.prop]),1)))),256)),c("td",L,m(b(e).allin),1)])])])]),c("div",T,[c("div",R,[c("div",F,[P,c("div",U,[v(c("input",{type:"date",class:"form-control mb-3","onUpdate:modelValue":t[0]||(t[0]=a=>f.value=a)},null,512),[[y,f.value]])]),c("div",{class:"modal-footer"},[z,c("button",{type:"button",class:"btn btn-primary",onClick:w},"添加")])])])]),c("div",N,[(r(!0),d(i,null,u(b(e).compData,(a=>(r(),d("div",V,[c("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#coll${a.date}`,"aria-expanded":"false","aria-controls":`coll${a.date}`},[c("div",q,[c("div",G,m(a.date),1),c("div",H,"￥"+m(a.allin),1)])],8,X),c("div",{id:`coll${a.date}`,class:"accordion-collapse collapse show","data-bs-parent":"#accordionExample"},[c("div",K,[(r(!0),d(i,null,u(b(l),(t=>(r(),d("div",Q,[c("div",W,[c("span",Y,[c("i",{class:p(t.icon)},null,2),h("  "+m(t.label)+":",1)]),Z,c("button",{type:"button",class:"btn btn-outline-secondary",onClick:e=>function(a,t,e){let l=a.target,s=l.previousSibling.value;s&&(t[e].add(Number(s)),l.previousSibling.value=null)}(e,a.cateObj,t.prop)},"+",8,aa)]),(r(!0),d(i,null,u(a.cateObj[t.prop].valueArr,((e,l)=>(r(),d("span",null,[c("code",null,m(e),1),c("span",ta,m(l==a.cateObj[t.prop].valueArr.length-1?"":"+"),1)])))),256))])))),256))])],8,J)])))),256))])]))}}),[["__scopeId","data-v-0736ea40"]]);const la=a=>(g("data-v-2a3b008a"),a=a(),f(),a),sa=la((()=>c("div",{id:"dailySpend",class:"chart"},null,-1))),oa=la((()=>c("div",{id:"typeSpend",class:"chart"},null,-1)));var na=e(l({__name:"TableCharts",props:{dataIns:null},setup(a){const t=a,e=x("categorys");let l=e.map((({prop:a,label:e})=>({name:e,type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:t.dataIns.compData.map((({cateObj:t})=>t[a].value))}))),s=e.map((({prop:a,label:e})=>({name:e,value:t.dataIns.summation[a],label:{show:!0}})));const o=[{dom:"dailySpend",ctx:null,option:{title:{text:"概览",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{bottom:"0"},xAxis:{type:"category",data:t.dataIns.compData.map((({date:a})=>a))},yAxis:{type:"value"},grid:{left:"3%",right:"4%",bottom:"8%",containLabel:!0},series:l}},{dom:"typeSpend",ctx:null,option:{title:{text:"类别消费统计",left:"center",top:"10%"},tooltip:{show:!0,formatter:({name:a,value:t,percent:e})=>`${a}-${t} (${e}%)`},series:[{name:"Access From",type:"pie",radius:"50%",label:{show:!0,formatter:({name:a,value:t,percent:e})=>`${a}-${t} (${e}%)`},data:s,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}];return n((()=>{o.forEach((a=>{let t=document.getElementById(a.dom);a.ctx=echarts.init(t),a.ctx.setOption(a.option,!0)}))})),(a,t)=>(r(),d(i,null,[sa,oa],64))}}),[["__scopeId","data-v-2a3b008a"]]);const ra={class:"container py-3"},da={class:"nav nav-tabs"},ca=["onClick"],ia=l({__name:"index",setup(a){const t=o(new k),e=o([{label:"数据记录表",prop:"table"},{label:"统计",prop:"statistic"}]),l=o("table");const s=o();return j("categorys",[{label:"吃的",prop:"food",icon:"bi bi-cake2-fill"},{label:"穿的",prop:"clothes",icon:"bi bi-incognito"},{label:"娱乐",prop:"entertainment",icon:"bi bi-controller"},{label:"交通",prop:"traffic",icon:"bi bi-car-front-fill"},{label:"日用",prop:"daily",icon:"bi bi-calendar"},{label:"其他",prop:"others",icon:"bi bi-alipay"}]),(a,o)=>(r(),d("div",ra,[c("ul",da,[(r(!0),d(i,null,u(e.value,(a=>(r(),d("li",{class:"nav-item",onClick:t=>{return e=a.prop,void(l.value=e);var e}},[c("a",{class:p({"nav-link":!0,active:l.value==a.prop}),"aria-current":"page"},m(a.label),3)],8,ca)))),256))]),"table"===l.value?(r(),w(ea,{key:0,dataIns:t.value,ref_key:"tableComp",ref:s},null,8,["dataIns"])):(r(),w(na,{key:1,dataIns:t.value},null,8,["dataIns"]))]))}});export{ia as default};
